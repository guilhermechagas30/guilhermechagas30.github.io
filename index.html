<!DOCTYPE html >
   <!-- https://guilhermechagas30.github.io/ -->
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Knauf Project's Visualization</title>
    <style type="text/css">
	
	#map {
        height: 100%;
		position: relative; 
      }
	  
	html, body {
        margin: 0;
        padding: 0;
		height: 100%;
		width: 100vw;
		color: #777;
		background-color: #6B777E;

      }
	  
	h1,h3,h4,h5,h6 {
		font-family: "Arial", sans-serif;
		margin-top: 0;
		margin-bottom: 0;
		margin-right: 0;
		margin-left: 0;
		font-size: 1vw;
	}
	
	h2 {
		font-family: "Arial", sans-serif;
		margin-top: 0;
		margin-bottom: 0;
		margin-right: 0;
		margin-left: 0;
		font-size: 2vw;
	}
		
	p {
		font-family: "Arial", sans-serif;
		margin-bottom:0;
		font-size: 1vw;
	}

	#contactform, #loginform { 
	  position: absolute; 
	  z-index: 1; /* The z-index should be higher than Google Maps */
	  width: 80vw;
		margin-left: auto;
		margin-right: auto;
		left: 0;
		right: 0;
	  padding: 1vw;
	  background: GhostWhite;
	  height: auto;
	  opacity: 0.95; 
	  color: black;
	  -webkit-border-radius:1vw;
	  -moz-border-radius:1vw;
	  border-radius:1vw;
	}
	
	#over_map { 
	  position: absolute; 
	  top: 50%;
	  z-index: 5;
	  width: 100vw;
	  margin: 1vw auto 0;
	  padding: 1vw;
	  background: GhostWhite;
	  height: auto;
	  opacity: 0.85; 
	  color: black;
	}

	select {
		padding:0.25vw;
		margin: 0;
		font-size:1vw;
		-webkit-border-radius:0.45vw;
		-moz-border-radius:0.45vw;
		border-radius:0.45vw;
		background: #778899;
		color:#F0F0F0;
		border:none;
		outline:none;
		display: inline-block;
		-webkit-appearance:none;
		-moz-appearance:none;
		appearance:none;
		cursor:pointer;
	}

	input[type="reset"]{
		padding:0.25vw;
		margin: 0;
		font-size:1vw;
		-webkit-border-radius:0.45vw;
		-moz-border-radius:0.45vw;
		border-radius:0.45vw;
		background: #424d57;
		color:#F0F0F0;
		border:none;
		outline:none;
		display: inline-block;
		-webkit-appearance:none;
		-moz-appearance:none;
		appearance:none;
		cursor:pointer;
	}

	input[type="button"]{
		padding:0.25vw;
		margin: 0;
		font-size:1vw;
		-webkit-border-radius:0.45vw;
		-moz-border-radius:0.45vw;
		border-radius:0.45vw;
		background: #424d57;
		color:#F0F0F0;
		border:none;
		outline:none;
		display: inline-block;
		-webkit-appearance:none;
		-moz-appearance:none;
		appearance:none;
		cursor:pointer;
	}

	input[type=text]{
		width: 8vw;
		font-size:1vw;
	} 
	

</style>
	
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
	
	var query_selected;
		
		
		$(document).keyup(function (e) {
			if ($(".input1:focus") && (e.keyCode === 13)) {
			   alert('Please use the buttons')
			}
		 });
		
		
		//hide buttons
		$('#Cat2').hide();
		$('#Cat2_label').hide();
		$('#Cat2 optgroup').hide();
		
		$('#Cat3').hide();
		$('#Cat3_label').hide();
		$('#Cat3 optgroup').hide();
		
		$('#Cat4').hide();
		$('#Cat4_label').hide();
		$('#Cat4 optgroup').hide();
		
		$('#PROJECTSTAGE').hide();
		$('#PROJECTSTAGE_label').hide();
		$('#PROJECTSTAGE optgroup').hide();
		
		
		
        $('#Cat1').change(function(){
            var text= $(this).val();
			
			$('#Cat2 optgroup').hide();   
			$('#Cat2').val('');
			if (text == "" || text == null) {
				$('#Cat2').hide();
				$('#Cat2_label').hide();
			}else {
				$('#Cat2').show();
				$('#Cat2_label').show();
				$('#Cat2 optgroup[label="'+text+'"]').css({'display':'block'});
			}
			
			$('#Cat3 optgroup').hide();   
			$('#Cat3').val('');
			if (text == "" || text == null) {
				$('#Cat3').hide();
				$('#Cat3_label').hide();
			}
			else if (text == "Projects") {
				$('#Cat3').show();
				$('#Cat3_label').show();
				$('#Cat3 optgroup[label="'+text+'"]').css({'display':'block'});
			}
			else {
				$('#Cat3').hide();
				$('#Cat3_label').hide();
			}
			
			$('#Cat4 optgroup').hide();   
			$('#Cat4').val('');
			if (text == "" || text == null) {
				$('#Cat4').hide();
				$('#Cat4_label').hide();
			}
			else if (text == "Projects") {
				$('#Cat4').show();
				$('#Cat4_label').show();
				$('#Cat4 optgroup[label="'+text+'"]').css({'display':'block'});
			}
			else {
				$('#Cat4').hide();
				$('#Cat4_label').hide();
			}
			
			$('#PROJECTSTAGE optgroup').hide();   
			$('#PROJECTSTAGE').val('');
			if (text == "" || text == null) {
				$('#PROJECTSTAGE').hide();
				$('#PROJECTSTAGE_label').hide();
			}
			else if (text == "Projects") {
				$('#PROJECTSTAGE').show();
				$('#PROJECTSTAGE_label').show();
				$('#PROJECTSTAGE optgroup[label="'+text+'"]').css({'display':'block'});
			}
			else {
				$('#PROJECTSTAGE').hide();
				$('#PROJECTSTAGE_label').hide();
			}
			
        });
			
    });
</script>

	
	
	
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB853I4mzALei8CvofzFD173gLG7Hbddys&callback=initMap"></script>
    <script>
      //icons used	  
	  var customLabel = {
        a: {label: 'A.png'},
        c: { label: 'C.png'},
		d: { label: 'D.png'},
		s: { label: 'S.png'},
		t: { label: 'T.png'},
		grn_blank: { label: 'grn-blank.png'},
		grn_circle: { label: 'grn-circle.png'},
		grn_diamond: { label: 'grn-diamond.png'},
		grn_square: { label: 'grn-square.png'},
		grn_stars: { label: 'grn-stars.png'},
		ltblu_blank: { label: 'ltblu-blank.png'},
		ltblu_circle: { label: 'ltblu-circle.png'},
		ltblu_diamond: { label: 'ltblu-diamond.png'},
		ltblu_square: { label: 'ltblu-square.png'},
		ltblu_stars: { label: 'ltblu-stars.png'},
		orange_blank: { label: 'orange-blank.png'},
		orange_circle: { label: 'orange-circle.png'},
		orange_diamond: { label: 'orange-diamond.png'},
		orange_square: { label: 'orange-square.png'},
		orange_stars: { label: 'orange-stars.png'},
		pink_blank: { label: 'pink-blank.png'},
		pink_circle: { label: 'pink-circle.png'},
		pink_diamond: { label: 'pink-diamond.png'},
		pink_square: { label: 'pink-square.png'},
		pink_stars: { label: 'pink-stars.png'},
		purple_blank: { label: 'purple-blank.png'},
		purple_circle: { label: 'purple-circle.png'},
		purple_diamond: { label: 'purple-diamond.png'},
		purple_square: { label: 'purple-square.png'},
		purple_stars: { label: 'purple-stars.png'},
		wht_blank: { label: 'wht-blank.png'},
		wht_circle: { label: 'wht-circle.png'},
		wht_diamond: { label: 'wht-diamond.png'},
		wht_square: { label: 'wht-square.png'},
		wht_stars: { label: 'wht-stars.png'},
		ylw_blank: { label: 'ylw-blank.png'},
		ylw_circle: { label: 'ylw-circle.png'},
		ylw_diamond: { label: 'ylw-diamond.png'},
		ylw_square: { label: 'ylw-square.png'},
		ylw_stars: { label: 'ylw-stars.png'},
      };
			
			//Initialize Map
			function initMap() {
			
				//unhide over_map
				//var x = document.getElementById('over_map');
				//x.style.display = 'block';
				
			
			var map = new google.maps.Map(document.getElementById('map'), {
			  center: new google.maps.LatLng(10.796249575513844, 106.71280633544916),
			  zoom: 4
			});
			var infoWindow = new google.maps.InfoWindow;

          // Change this depending on the name of your PHP or XML file
				var url = 'xml_test.xml';
			
			downloadUrl(url, function(data) {
            
					var xml = data.responseXML;
					var markers = xml.documentElement.getElementsByTagName('marker');					
			
			 makers_on_map();
			
			//hide over_map
				//var x = document.getElementById('over_map');
				//x.style.display = 'block';
				//	x.style.display = 'none';
			
          });
        }
		
		
		//markers on map
		function makers_on_map (){
		
			Array.prototype.forEach.call(markers, function(markerElem) {

				//icon
				var iconBase = 'https://maps.google.com/mapfiles/kml/paddle/';
				var type = markerElem.getAttribute('icon');
				var icon_marker = customLabel[type] || {};
				var image = {
				  url: iconBase + icon_marker.label,
				  size: new google.maps.Size(64, 64),
				  origin: new google.maps.Point(0, 0),
				  anchor: new google.maps.Point(16, 32),
				  scaledSize: new google.maps.Size(32, 32)
				};
				
				//coordinates
				var point = new google.maps.LatLng(
                  parseFloat(markerElem.getAttribute('latitude')),
                  parseFloat(markerElem.getAttribute('longitude')));
				  
				  
				//info text
				
				var infowincontent = document.createElement('div');
				
				var headers_val = [
				'stage',
				'id',
				'type',
				'name',
				'const_start',
				'value',
				'floor_area',
				'storeys',
				'owner_type',
				'dev_type',
				'contact_details'
				];
							  
				for (i = 0; i < headers_val.length; i++) {
					temp0 = document.createElement('strong');
					temp1 = document.createElement('text');
					temp2 = document.createElement('br');
					
					if (headers_val[i] == 'contact_details') {
						
						temp0.textContent = headers_val[i] + ": ";
						infowincontent.appendChild(temp0);
							
						var temp = markerElem.getAttribute(headers_val[i]);
						var t = temp.split('\\n'),
							 j;
						if(t[0].length>0){         
							infowincontent.appendChild(document.createTextNode(t[0]));
						}
						for(j=1;j<t.length;j++){
							infowincontent.appendChild(document.createElement('BR'));
							if(t[j].length>0){
								//strong and line breaks for contacts
								if (t[j].indexOf('\\t\\t') !== -1){
									infowincontent.appendChild(document.createTextNode(t[j].replace('\\t\\t','... ')));
								}else{
									var temp_cont = document.createElement('strong');
									temp_cont.textContent = t[j].replace('\\t','. ');
									infowincontent.appendChild(temp_cont);
								}	
							}
						} 
									
						infowincontent.appendChild(temp2);
					}else{
					
						temp0.textContent = headers_val[i] + ": ";
						temp1.textContent = markerElem.getAttribute(headers_val[i]);
						
						infowincontent.appendChild(temp0);
						infowincontent.appendChild(temp1);
						infowincontent.appendChild(temp2);
					
					}
				}
				
				
				//XML categories
				var cat0_xml = markerElem.getAttribute('cat0');
				var cat1_xml = markerElem.getAttribute('cat1');
				var cat2_xml = markerElem.getAttribute('cat2');
				var cat3_xml = markerElem.getAttribute('cat3');
				var cat4_xml = markerElem.getAttribute('cat4');
				var search_xml = markerElem.getAttribute('name').toLowerCase() + ' ' +  markerElem.getAttribute('contact_details').toLowerCase(); 
				
				var Cat0 = document.getElementById('Cat0').value;
				var Cat1 = document.getElementById('Cat1').value;
				var Cat2 = document.getElementById('Cat2').value;
				var Cat3 = document.getElementById('Cat3').value;
				var Cat4 = document.getElementById('Cat4').value;
				var search = document.getElementById('ID').value;
				
				if (  ((Cat0 == cat0_xml) || (Cat0 == "")) 
						&& ((Cat1 == cat1_xml) || (Cat1 == "")) 
						&& ((Cat2 == cat2_xml) || (Cat2 == "")) 
						&& ((Cat3 == cat3_xml) || (Cat3 == "")) 
						&& ((Cat4 == cat4_xml) || (Cat4 == "")) 
						&& ((search_xml.indexOf(search.toLowerCase()) !== -1) || (search == "")) 
					) {
				
					//draw markers on map
					  var marker = new google.maps.Marker({
						map: map,
						position: point,
						//label: 'hello world',
						icon: image
					  });
					  
					//click function
					marker.addListener('click', function() {
						infoWindow.setContent(infowincontent);
						infoWindow.open(map, marker);
					});
			  
				}			
            });
		
		}
		
		

      function downloadUrl(url, callback) {
	  
			var request = window.ActiveXObject ?
				new ActiveXObject('Microsoft.XMLHTTP') :
				new XMLHttpRequest;

			request.onreadystatechange = function() {
			  if (request.readyState == 4) {
				request.onreadystatechange = doNothing;
				callback(request, request.status);
			  }
			};

			request.open('GET', url, true);
			request.send(null);
      }
	  
	  
	  
		window.onload=function(){
		
		
			document.getElementById("reset").addEventListener("click", function(){
					 var reset_button = 0;
					initMap();
				});
			
			document.getElementById("enter").addEventListener("click", function(){
					 var reset_button = 0;
					 initMap();
				});
				
				
		}
	  
	  
      function doNothing() {}
    </script>
	
  </head>

  <body>
    
	<div id="contactform">
	
		<center><h2>Knauf Market Map</h2></center>
			
			<p>Filters</p>
					
					<form>
					<table style="width:">
			
					<td>
					
						<input id="enter" value ="apply filters" type="button">
						
						</br>
						</br>
						
						<input id= "reset" type="reset" value="reset" type="button"/>

					</td>
					<td>
					</td>
					<td>
					
						<!-- auto filled menu -->
						<select id="Cat0">
							<option value="" selected="selected">--Select--</option>
							<option value="Indonesia">Indonesia</option>
							<option value="Philippines">Philippines</option>
							<option value="Thailand">Thailand</option>
							<option value="Vietnam">Vietnam</option>
						</select>
						
						
						<select id="Cat1">
						  <option value="" selected="selected">--Select--</option>
						  <option value="Sub-dealers">Sub-dealers</option>
						  <option value="Stakeholders">Stakeholders</option>
						  <option value="Projects">Projects</option>
						</select>
						
					
						<select id="Cat2">
						<optgroup label="Sub-dealers">
										<option value="">--Select--</option>
										<option value="Importer">Importer</option>
										<option value="Distributor">Distributor</option>
						   </optgroup>
						   <optgroup label="Stakeholders">
										<option value="">--Select--</option>
										<option value="Specifiers">Specifiers</option>
										<option value="Owner/Property Developers">Owner/Property Developers</option>
										<option value="Contractors">Contractors</option>
										<option value="Government">Government</option>
										<option value="NA">Classification Pending</option>
						   </optgroup>
							<optgroup label="Projects">					
										<option value="">--Select--</option>
										<option value="Hotel">Hotel</option>
										<option value="Multi-Use">Multi-Use</option>
										<option value="Office">Office</option>
										<option value="Residential">Residential</option>
										<option value="Retail">Retail</option>
						   </optgroup>
						   </select>

						 <select id="Cat3">
						   <optgroup label="Importer">
						   </optgroup>
						   <optgroup label="Sub-dealers">
						   </optgroup>
						   <optgroup label="Stakeholders">
						   </optgroup>
							<optgroup label="Projects">
										<option value="">--Select--</option>
										<option value="Alteration/Addition">Alteration/Addition</option>
										<option value="New Building/Construction">New Building/Construction</option>
										<option value="Interior Decoration">Interior Decoration</option>
										<option value="Refurbishment">Refurbishment</option>
										<option value="Extension">Extension</option>
						   </optgroup>
						   </select>     

						   
						 <select id="Cat4">
						   <optgroup label="Importer">
						   </optgroup>
						   <optgroup label="Sub-dealers">
						   </optgroup>
						   <optgroup label="Stakeholders">
						   </optgroup>
							<optgroup label="Projects">
										<option value="">--Select--</option>
										<option value="Unclassified">Unclassified</option>
										<option value="Commercial">Commercial</option>
										<option value="Government">Government</option>
										<option value="Private Home Owner">Private Home Owner</option>
						   </optgroup>
						   </select>


						 <select id="PROJECTSTAGE">
						   <optgroup label="Importer">
						   </optgroup>
						   <optgroup label="Sub-dealers">
						   </optgroup>
						   <optgroup label="Stakeholders">
						   </optgroup>
							<optgroup label="Projects">
										<option value="">--Select--</option>
										<option value="Concept">Concept</option>
										<option value="Construction: Main Contract Awarded">Construction: Main Contract Awarded</option>
										<option value="Construction: Subcontract(s) Awarded">Construction: Subcontract(s) Awarded</option>
										<option value="Construction: Subcontract(s) Tender">Construction: Subcontract(s) Tender</option>
										<option value="Design">Design</option>
										<option value="Documentation">Documentation</option>
										<option value="Post tender">Post tender</option>
										<option value="Tender">Tender</option>
			
						   </optgroup>
						   </select>    

						
						<p>
							Keyword: 
							<input type="text" id= "ID" name="ID">					
						</p>
					
					</td>
					
					</table>
					</form>
				
						

	</div>
	
	 <div id="over_map">
			<center><h2>Loading... Please wait.</h2></center>
	 </div>
	
	<div id="map"></div>	
	
  </body>
</html>
